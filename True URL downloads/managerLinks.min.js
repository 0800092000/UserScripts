function getLinks(){document.querySelectorAll("a");[].forEach.call(document.querySelectorAll("a"),function(e){resReg.test(e.href)&&-1==linksArr.toString().indexOf(e.href)&&linksArr.push(e.href)})}function showLinkFrame(e){var n=[],i="类型：";return frame||(frame=$('<div id="managerLinksContent" style="display:none;">\n		<div style="height:100%; width:100%; position:fixed; top:0; z-index:99998; opacity:0.3; filter: alpha(opacity=30); background-color:#000;"></div>\n		<div id="managerLinksBody" style="width:300px;height:300px;position:fixed;left:50%;top:50%;margin-top:-150px;margin-left:-150px;z-index:99998;background-color:#ffffff;border:1px solid #afb3b6;border-radius:10px;opacity:0.95;filter:alpha(opacity=95);box-shadow:5px 5px 20px 0px #000;">\n			<div id="managerLinksType" style="width:290px;margin-left:5px;"></div>\n			<div><input id="managerLinksSortByName" value="按文件名排序" style="width: 33.3%;font-size:12px" type="button"><input id="managerLinksSortByUrl" value="按网址排序" style="width: 33.3%;font-size:12px" type="button"><input id="managerLinksSortByType" value="按扩展名排序" style="width: 33.3%;font-size:12px" type="button">\n			</div>\n			<div id="managerLinksLinks" style="width:100%;overflow:auto;word-wrap:break-word;font-size:12px"></div>\n			<div title="%i代表递增 %n代表文件名"><input id="managerLinksPre" style="width: 48%;font-size:12px" type="text" placeholder="批量前缀"><input id="managerLinksAfter" style="width: 48%;font-size:12px" type="text" placeholder="批量后缀">\n			</div>\n			<div><input id="managerLinksCopyAll" value="全部复制" style="width: 33.3%;font-size:12px" type="button"><input id="managerLinksCopySel" value="复制选中" style="width: 33.3%;font-size:12px" type="button"><input id="managerLinksClose" value="关闭" style="width: 33.3%;font-size:12px" type="button">\n			</div>\n		</div>\n		</div>'),$(document.body).append(frame),$("#managerLinksSortByName").click(function(){$("#managerLinksLinks").html(""),n.sort(by("linkName","href")),n.forEach(function(e){$("#managerLinksLinks").append(e.item)})}),$("#managerLinksSortByUrl").click(function(){$("#managerLinksLinks").html(""),n.sort(by("href","type")),n.forEach(function(e){$("#managerLinksLinks").append(e.item)})}),$("#managerLinksSortByType").click(function(){$("#managerLinksLinks").html(""),n.sort(by("type","href")),n.forEach(function(e){$("#managerLinksLinks").append(e.item)})}),$("#managerLinksCopyAll").click(function(){var i=$("#managerLinksPre").val(),t=$("#managerLinksAfter").val(),a="",r=0;n.forEach(function(e){r++;var n=decodeURIComponent(e.linkName);a+=i.replace(/%i/g,r+"").replace(/%n/g,n)+e.href+t.replace(/%i/g,r+"").replace(/%n/g,n)+"\n"}),e(a)}),$("#managerLinksCopySel").click(function(){var i=$("#managerLinksPre").val(),t=$("#managerLinksAfter").val(),a="",r=0;n.forEach(function(e){if(r++,e.item[0].checked){var n=decodeURIComponent(e.linkName);a+=i.replace(/%i/g,r+"").replace(/%n/g,n)+e.href+t.replace(/%i/g,r+"").replace(/%n/g,n)+"\n"}}),e(a)}),$("#managerLinksClose").click(function(){frame.hide()}),$("#managerLinksContent>div")[0].onclick=function(){frame.hide()}),getLinks(),0==linksArr.length?void e():($("#managerLinksLinks").html(""),linksArr.forEach(function(e){var t=e.replace(resReg,"$1"),a=-1==t.indexOf(".")?e:e.replace(/.*\/([^\/]+)$/i,"$1");-1==i.indexOf(t)&&(i+='<a href="javascript:void(0);">'+t+"</a> ");var r=$('<input type="checkbox" style="float:left;"/><a href="'+e+'" style="width:230px;display:block;overflow:hidden;word-break:keep-all;white-space:nowrap;text-overflow:ellipsis;float:left">'+decodeURIComponent(a)+"</a><br>");$("#managerLinksLinks").append(r),n.push({item:r,href:e,type:t,linkName:a})}),$("#managerLinksType").html(i),$("#managerLinksType>a").click(function(){var e="underline"==this.style.textDecoration;this.style.textDecoration=e?"":"underline";var i=this.innerHTML;n.forEach(function(n){n.type==i&&(n.item[0].checked=!e)})}),frame.show(),$("#managerLinksLinks").height($("#managerLinksBody").height()-$("#managerLinksType").height()-3*$("#managerLinksSortByName").height()-20),$("#managerLinksBody").hide(),void $("#managerLinksBody").show("slow"))}var resReg=/.*(^magnet|^ed2k|\.torrent$|\.mp4$|\.rar$|\.7z$|\.zip$|\.rmvb$|\.mkv$|\.avi$|\.iso$|\.mp3$|\.txt$|\.exe$|\.chm$|\.pdf$|\.ppt$|\.doc$|\.pptx$|\.docx$|\.epub$|\.xlsx$|\.xls$|\.flac$|\.wma$|\.wav$|\.aac$|\.ape$|\.mid$|\.ogg$|\.m4a$|\.dts$|\.dsd$|\.apk$).*/i,linksArr=[],frame,by=function(e,n){var i=function(e,n,i){var t,a;if("object"==typeof e&&"object"==typeof n&&e&&n)return t=e[i],a=n[i],t===a?0:typeof t==typeof a?a>t?-1:1:typeof a>typeof t?-1:1;throw"error"};return function(t,a){var r=i(t,a,e);return n&&0==r&&(r=i(t,a,n)),r}};